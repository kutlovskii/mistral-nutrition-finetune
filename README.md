# Fine-Tuning Mistral-7B-Instruct on NutritionQA

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ `Mistral-7B-Instruct` –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ –ø–∏—Ç–∞–Ω–∏—é (`NutritionQA`), —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LoRA –∏ 8-bit –∑–∞–≥—Ä—É–∑–∫–∏. –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å –∑–∞–ø—É—Å–∫–æ–º –≤ Google Colab.

## üöÄ –ó–∞–ø—É—Å–∫ –≤ Google Colab

### 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
!git clone https://github.com/kutlovskii/mistral-nutrition-finetune.git
%cd mistral-nutrition-finetune

### 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

!pip install -r requirements.txt


3. –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞—Ç–∞—Å–µ—Ç –≤—Ä—É—á–Ω—É—é

from google.colab import files
uploaded = files.upload()  # –ó–∞–≥—Ä—É–∑–∏ test-00000-of-00001.parquet

4. –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å

!python src/train.py

5. –û—Ü–µ–Ω–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç

!python src/evaluate.py


–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞

–ú–æ–¥–µ–ª—å: Mistral-7B-Instruct-v0.1 ‚Äî –æ—Ç–∫—Ä—ã—Ç–∞—è –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å, —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å LoRA –∏ 8bit, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è fine-tuning –≤ Colab.
–î–∞—Ç–∞—Å–µ—Ç: NutritionQA —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞—Ä–∞–Ω–µ–µ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ –ø–∞—Ä—ã "–≤–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç", –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–ª—è supervised fine-tuning. –í—Ç–æ—Ä–æ–π –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (Food Facts) –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è, —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 8-bit –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ (—á–µ—Ä–µ–∑ bitsandbytes) –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ VRAM.
Fine-tuning –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ LoRA (peft) ‚Äî –±—ã—Å—Ç—Ä–æ –∏ —ç–∫–æ–Ω–æ–º–∏—á–Ω–æ.
–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Google Colab —Å GPU (T4 –∏ –≤—ã—à–µ).
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è Perplexity-–æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É evaluate.
